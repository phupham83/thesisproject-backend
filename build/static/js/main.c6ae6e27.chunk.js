(this.webpackJsonpthesisproject=this.webpackJsonpthesisproject||[]).push([[0],{44:function(t,e,n){},69:function(t,e,n){"use strict";n.r(e);var c=n(1),r=n(19),a=n.n(r),s=n(5),u=(n(44),n(0)),i=function(){return Object(u.jsx)("h3",{children:"404 Not Found"})},o=n(16),l=n(2),j=n.n(l),d=n(6),b=n(14),p=n(13),O=n.n(p),f="/api/login",h=function(){var t=Object(d.a)(j.a.mark((function t(e){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post(f,e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=Object(d.a)(j.a.mark((function t(){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get(f+"/local_login");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),v=function(){var t=Object(d.a)(j.a.mark((function t(){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get(f+"/logout");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m={login:h,signup:function(){var t=Object(d.a)(j.a.mark((function t(e){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post("/api/users",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),localLogin:x,logOut:v,revoke:function(){var t=Object(d.a)(j.a.mark((function t(){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.put("/api/users/revoke");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},g={getConsent:function(){window.location.href="/api/obpApi/connect"},getAccounts:function(){var t=Object(d.a)(j.a.mark((function t(){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get("/api/obpApi/getMyAccounts");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),getTransactions:function(){var t=Object(d.a)(j.a.mark((function t(e,n){var c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get("/api/obpApi/getTransactions/"+e+"/"+n);case 2:return c=t.sent,t.abrupt("return",c.data);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),getBalance:function(){var t=Object(d.a)(j.a.mark((function t(e){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get("/api/obpApi/getBalance/"+e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOGIN":return e.data;case"LOCAL_LOGIN":return e.data,e.data;case"LOGOUT":return null;case"SIGN_UP":case"GET_CONSENT":return console.log(e.data),t;case"REVOKE_CONSENT":return e.data;case"GET_ACCOUNTS":return Object(b.a)(Object(b.a)({},t),{},{accounts:e.data});case"NO_ACCOUNTS":return t;case"GET_TRANSACTIONS":case"GET_BALANCE":return e.data;default:console.log("")}return t},y=n(3),k=function(t){var e=t.transactions,n=t.totalBalance;if(e[0]){e.sort((function(t,e){return new Date(e.details.completed)-new Date(t.details.completed)}));var c=n;return Object(u.jsx)("ul",{children:e.map((function(t){var e=c;return c-=Number(t.details.value.amount),Object(u.jsxs)("li",{children:["Balance: ",e.toFixed(2)," Transfer amount: ",t.details.value.amount," Description: ",t.details.description," Completed: ",t.details.completed]},t.id)}))})}return Object(u.jsx)("h1",{children:"Loading ..."})},N=function(t){var e=t.transactions,n=t.balances;return e[0]?Object(u.jsx)("ul",{children:e.map((function(t){return Object(u.jsxs)("li",{children:["Balance: ",t.details.new_balance.amount," Transfer amount: ",t.details.value.amount," Description: ",t.details.description]},t.id)}))}):n[0]?Object(u.jsx)("ul",{children:n.map((function(t){return Object(u.jsxs)("li",{children:["Balance: ",t.amount]},t.amount)}))}):Object(u.jsx)("h1",{children:"Loading ..."})},T=n(7),A=function(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.user}));Object(c.useEffect)((function(){t(function(t){return function(){var e=Object(d.a)(j.a.mark((function e(n){var c,r,a,s,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.consent){e.next=19;break}return e.prev=1,e.next=4,g.getAccounts();case 4:return c=e.sent,r=function(t,e){return t&&e?[].concat(Object(o.a)(e),Object(o.a)(t)):e},a=c.accounts.map(function(){var t=Object(d.a)(j.a.mark((function t(e){var n,c,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.getBalance(e.bank_id);case 2:return n=t.sent,t.next=5,g.getTransactions(e.bank_id,e.id);case 5:return c=t.sent,a=n.accounts.reduce((function(t,n){return n.account_id===e.id?(t.push(n.balances.reduce(r)),t):t}),[]),t.abrupt("return",Object(b.a)(Object(b.a)({},e),{},{transactions:c.transactions,balances:a}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.next=9,Promise.all(a);case 9:s=e.sent,u=Object(b.a)(Object(b.a)({},t),{},{accounts:s}),n({type:"GET_TRANSACTIONS",data:u}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:e.next=20;break;case 19:n({type:"NO_ACCOUNTS"});case 20:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}()}(e))}),[t]);var n=Object(y.g)(),r=e.accounts?e.accounts:[],a=e.accounts&&e.accounts[0].transactions?e.accounts.map((function(t){return t.transactions})):null,i=e.accounts&&e.accounts[0].balances?e.accounts.map((function(t){return t.balances})):null,l=a?a.reduce((function(t,e){return t?[].concat(Object(o.a)(e),Object(o.a)(t)):e}),[]):[],p=i?i.reduce((function(t,e){return t+e.reduce((function(t,e){return t+Number(e.amount)}),0)}),0):0;return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Transactions"}),e.consent?Object(u.jsx)("div",{children:Object(u.jsxs)(T.a,{children:[Object(u.jsxs)("div",{children:[Object(u.jsx)(T.b,{to:"/transactions/All_accounts",children:Object(u.jsx)("button",{children:"All accounts"})}),r.map((function(t){return Object(u.jsx)(T.b,{to:"/transactions/"+t.bank_id+"/"+t.id,children:Object(u.jsx)("button",{children:t.bank_id})},t.id)}))]}),Object(u.jsxs)(y.d,{children:[r.map((function(t){return Object(u.jsx)(y.b,{path:"/transactions/"+t.bank_id+"/"+t.id,children:Object(u.jsx)(N,{transactions:t.transactions,balances:t.balances})},t.id)})),Object(u.jsx)(y.b,{path:"/transactions/All_accounts",children:Object(u.jsx)(k,{transactions:l,totalBalance:p})}),Object(u.jsx)(y.b,{exact:!0,path:"/transactions",children:Object(u.jsx)(k,{transactions:l,totalBalance:p})})]})]})}):Object(u.jsxs)("div",{className:"addAccount",children:[Object(u.jsx)("p",{children:"Please add an account to start"}),Object(u.jsx)("button",{onClick:function(t){t.preventDefault(),n.push("/consent")},children:"Add account"})]})]})},C=function(t){return function(e){e({type:"SET_MESSAGE",data:t}),setTimeout((function(){return e({type:"SET_MESSAGE",data:null})}),3e3)}},S=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_MESSAGE":return e.data;default:console.log("")}return t},_=function(){var t=Object(s.c)((function(t){return t.message})),e={border:"solid",padding:10,borderWidth:1,display:t?"":"none"};return Object(u.jsx)("div",{style:e,children:t})},E=function(){var t=Object(s.b)(),e=Object(y.g)();return Object(u.jsxs)("div",{children:[Object(u.jsx)(_,{}),Object(u.jsx)("h2",{children:"Log in to application"}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault();var c=n.target.Username.value,r=n.target.Password.value;t(function(t,e,n,c){return function(){var r=Object(d.a)(j.a.mark((function r(a){var s;return j.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,m.login({username:t,password:e});case 3:s=r.sent,a({type:"LOGIN",data:s}),n(),r.next=12;break;case 8:r.prev=8,r.t0=r.catch(0),console.log(r.t0),c("Wrong username or password");case 12:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(t){return r.apply(this,arguments)}}()}(c,r,(function(){return e.push("/")}),(function(e){t(C(e))})))},children:[Object(u.jsxs)("div",{children:["Username",Object(u.jsx)("input",{type:"text",name:"Username",id:"username"})]}),Object(u.jsxs)("div",{children:["Password",Object(u.jsx)("input",{type:"password",name:"Password",id:"password"})]}),Object(u.jsx)("button",{id:"login-button",type:"submit",children:"Login"})]})]})},L=function(){var t=Object(s.b)(),e=Object(y.g)();return Object(u.jsx)("button",{onClick:function(n){n.preventDefault();t(function(t){return function(){var e=Object(d.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.logOut();case 2:n({type:"LOGOUT"}),t();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}((function(){return e.push("/")})))},children:"Log out"})},G=function(){var t=Object(s.b)(),e=Object(y.g)();return Object(u.jsxs)("div",{children:[Object(u.jsx)(_,{}),Object(u.jsx)("h2",{children:"Sign up for the application"}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault();var c=n.target.Username.value,r=n.target.Password.value,a=n.target.Name.value;t(function(t,e,n,c,r){return function(){var a=Object(d.a)(j.a.mark((function a(s){var u;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,m.signup({username:t,name:e,password:n});case 3:u=a.sent,s({type:"SIGN_UP",data:u}),r("Sign up successful"),c(),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(0),console.log(a.t0),r(a.t0.response.data.error);case 13:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(t){return a.apply(this,arguments)}}()}(c,a,r,(function(){return e.push("/")}),(function(e){t(C(e))})))},children:[Object(u.jsxs)("div",{children:["Username",Object(u.jsx)("input",{type:"text",name:"Username",id:"username"})]}),Object(u.jsxs)("div",{children:["Name",Object(u.jsx)("input",{type:"text",name:"Name",id:"name"})]}),Object(u.jsxs)("div",{children:["Password",Object(u.jsx)("input",{type:"password",name:"Password",id:"password"})]}),Object(u.jsx)("button",{id:"signup-button",type:"submit",children:"Sign up"})]})]})},U=function(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.user}));return Object(u.jsx)("div",{children:e?Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Consent confirmation"}),Object(u.jsx)("p",{children:"By accepting you are allowing your data to be accessed"}),Object(u.jsx)("button",{onClick:function(e){e.preventDefault(),t(function(){var t=Object(d.a)(j.a.mark((function t(e){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.getConsent();case 3:n=t.sent,e({type:"GET_CONSENT",data:n}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}())},children:"Confirm"})]}):Object(u.jsx)(y.a,{to:"/"})})},B=function(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.user}));Object(c.useEffect)((function(){t(function(t){return function(){var e=Object(d.a)(j.a.mark((function e(n){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.consent){e.next=13;break}return e.prev=1,e.next=4,g.getAccounts();case 4:c=e.sent,n({type:"GET_ACCOUNTS",data:c.accounts}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:e.next=14;break;case 13:n({type:"NO_ACCOUNTS"});case 14:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()}(e))}),[]);var n=Object(y.g)();return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Accounts"}),e.consent?Object(u.jsx)("div",{className:"showAccount",children:Object(u.jsxs)("ul",{children:[e.accounts?e.accounts.map((function(t){return Object(u.jsx)("li",{children:t.bank_id},t.id)})):Object(u.jsx)("li",{children:"Loading"}),e.accounts?Object(u.jsx)("button",{onClick:function(e){e.preventDefault(),t(function(){var t=Object(d.a)(j.a.mark((function t(e){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.revoke();case 3:n=t.sent,e({type:"REVOKE_CONSENT",data:n}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}())},children:"Revoke Consent"}):Object(u.jsx)("li",{})]})}):Object(u.jsxs)("div",{className:"addAccount",children:[Object(u.jsx)("p",{children:"Please add an account to start"}),Object(u.jsx)("button",{onClick:function(t){t.preventDefault(),n.push("/consent")},children:"Add account"})]})]})},D=function(){var t=Object(s.b)();Object(c.useEffect)((function(){t(function(){var t=Object(d.a)(j.a.mark((function t(e){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.localLogin();case 2:n=t.sent,e({type:"LOCAL_LOGIN",data:n});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[t]);var e=Object(s.c)((function(t){return t.user})),n={padding:5};return Object(u.jsx)("div",{children:null===e?Object(u.jsx)(T.a,{children:Object(u.jsxs)(y.d,{children:[Object(u.jsxs)(y.b,{path:"/login",children:[Object(u.jsx)(T.b,{style:n,to:"/",children:"Home"}),Object(u.jsx)(E,{})]}),Object(u.jsxs)(y.b,{path:"/signup",children:[Object(u.jsx)(T.b,{style:n,to:"/",children:"Home"}),Object(u.jsx)(G,{})]}),Object(u.jsxs)(y.b,{exact:!0,path:"/",children:[Object(u.jsxs)("div",{children:[Object(u.jsx)(T.b,{style:n,to:"/login",children:"Login"}),Object(u.jsx)(T.b,{style:n,to:"/signup",children:"Sign Up"})]}),Object(u.jsx)(_,{})]}),Object(u.jsxs)(y.b,{path:"*",children:[Object(u.jsx)(T.b,{style:n,to:"/",children:"Home"}),Object(u.jsx)(i,{})]})]})}):Object(u.jsxs)(T.a,{children:[Object(u.jsxs)("div",{children:[Object(u.jsx)(T.b,{style:n,to:"/transactions",children:"Transactions"}),Object(u.jsx)(T.b,{style:n,to:"/accounts",children:"Accounts"}),Object(u.jsx)(T.b,{style:n,to:"/",children:"Home"}),Object(u.jsxs)("p",{children:[e.username," logged in ",Object(u.jsx)(L,{})]})]}),Object(u.jsxs)(y.d,{children:[Object(u.jsx)(y.b,{path:"/transactions",children:Object(u.jsx)(A,{})}),Object(u.jsx)(y.b,{path:"/accounts",children:Object(u.jsx)(B,{})}),Object(u.jsx)(y.b,{path:"/consent",children:Object(u.jsx)(U,{})}),Object(u.jsx)(y.b,{exact:!0,path:"/",children:Object(u.jsx)("h1",{children:"Welcome to your budget planner"})}),Object(u.jsxs)(y.b,{path:"*",children:[Object(u.jsx)(T.b,{style:n,to:"/",children:"Home"}),Object(u.jsx)(i,{})]})]})]})})},P=n(18),I=n(33),F=n(34),R=Object(P.combineReducers)({user:w,message:S}),H=Object(P.createStore)(R,Object(F.composeWithDevTools)(Object(P.applyMiddleware)(I.a))),M=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,70)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,a=e.getLCP,s=e.getTTFB;n(t),c(t),r(t),a(t),s(t)}))};a.a.render(Object(u.jsx)(s.a,{store:H,children:Object(u.jsx)(D,{})}),document.getElementById("root")),M()}},[[69,1,2]]]);
//# sourceMappingURL=main.c6ae6e27.chunk.js.map